<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VWSS Admin Panel</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #f4f4f4; }
    .form-wrapper, .count-section, .mass-timings-container {
      max-width: 700px; margin: 30px auto; background: white; padding: 20px;
      border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2, h3 { text-align: center; }
    label { display: block; margin: 15px 0 5px; }
    input, textarea {
      width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box;
    }
    button {
      margin-top: 15px; padding: 10px 15px; background: #007bff; color: white;
      border: none; border-radius: 5px; cursor: pointer;
    }
    button:hover { background: #0056b3; }
    .logout-container { text-align: right; margin: 0 auto; max-width: 700px; }
    .logout-button {
      background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 5px;
    }
    table { width: 100%; margin: 20px 0; border-collapse: collapse; }
    td, th { padding: 10px; border: 1px solid #ccc; }
  </style>
</head>
<body>

<!-- LOGIN SECTION -->
<div class="form-wrapper" id="login-section">
  <h2>Admin Login</h2>
  <form onsubmit="secureLogin(); return false;">
    <label>Email</label>
    <input type="email" id="login-email" required />
    <label>Password</label>
    <input type="password" id="login-password" required />
    <button type="submit">Login</button>
    <div id="login-error" style="color: red; margin-top: 10px;"></div>
  </form>
</div>

<!-- ADMIN SECTION -->
<div id="admin-content" style="display: none;">

  <!-- Logout -->
  <div class="logout-container">
    <button onclick="logout()" class="logout-button">Logout</button>
  </div>

  <!-- Member & Team Count -->
  <div class="form-wrapper">
    <h2>Update Member and Team Count</h2>
    <form onsubmit="submitCounts(); return false;">
      <label>Members Count</label>
      <input type="number" id="members-count" required>
      <label>Teams Count</label>
      <input type="number" id="teams-count" required>
      <button type="submit">Update Counts</button>
    </form>
  </div>

  <!-- Event Section -->
  <div class="form-wrapper">
    <h2>Update Events</h2>

    <h3>English Events</h3>
    <table>
      <thead><tr><th>Date</th><th>Info</th><th>Action</th></tr></thead>
      <tbody id="english-event-rows"></tbody>
    </table>

    <h3>தமிழ் நிகழ்வுகள்</h3>
    <table>
      <thead><tr><th>தேதி</th><th>விவரம்</th><th>செயல்</th></tr></thead>
      <tbody id="tamil-event-rows"></tbody>
    </table>
  </div>

  <!-- Announcements -->
  <div class="form-wrapper">
    <h2>Update Announcements</h2>

    <!-- English Announcement -->
    <form onsubmit="saveAnnouncement('english'); return false;">
      <h3>English Announcement</h3>
      <label>Title</label>
      <input type="text" id="english-title" required>
      <label>Information</label>
      <textarea id="english-info" required></textarea>
      <button type="submit">Update English</button>
    </form>

    <!-- Tamil Announcement -->
    <form onsubmit="saveAnnouncement('tamil'); return false;">
      <h3>தமிழ் அறிவிப்பு</h3>
      <label>தலைப்பு</label>
      <input type="text" id="tamil-title" required>
      <label>விவரம்</label>
      <textarea id="tamil-info" required></textarea>
      <button type="submit">புதுப்பிக்க</button>
    </form>

    <!-- Label -->
    <form onsubmit="saveAnnouncement('label'); return false;">
      <h3>Announcement Label</h3>
      <label>Title</label>
      <input type="text" id="label-title" required>
      <label>Information</label>
      <textarea id="label-info" required></textarea>
      <button type="submit">Update Label</button>
    </form>
  </div>
</div>

<!-- SCRIPT SECTION -->
<script>
  const VALID_EMAIL = "velankanniwalkerssocialservice@gmail.com";
  const VALID_PASSWORD = "avemariavwss";

  function secureLogin() {
    const email = document.getElementById("login-email").value.trim();
    const password = document.getElementById("login-password").value;
    if (email === VALID_EMAIL && password === VALID_PASSWORD) {
      localStorage.setItem("loggedIn", "true");
      showAdminContent();
    } else {
      document.getElementById("login-error").textContent = "Invalid email or password.";
    }
  }

  function showAdminContent() {
    document.getElementById("login-section").style.display = "none";
    document.getElementById("admin-content").style.display = "block";
    renderCounts();
    loadEvents();
  }

  function logout() {
    localStorage.removeItem("loggedIn");
    location.reload();
  }

  window.addEventListener("DOMContentLoaded", () => {
    if (localStorage.getItem("loggedIn") === "true") {
      showAdminContent();
    }
  });

  // === Member & Team Count ===
  function submitCounts() {
    const members = document.getElementById("members-count").value;
    const teams = document.getElementById("teams-count").value;
    localStorage.setItem("count_members", members);
    localStorage.setItem("count_teams", teams);
    alert("Counts updated!");
  }

  function renderCounts() {
    document.getElementById("members-count").value = localStorage.getItem("count_members") || "";
    document.getElementById("teams-count").value = localStorage.getItem("count_teams") || "";
  }

  // === Events (English & Tamil) ===
  const MAX_EVENTS = 5;

  function loadEvents() {
    const englishEvents = JSON.parse(localStorage.getItem("events_english") || "[]");
    const tamilEvents = JSON.parse(localStorage.getItem("events_tamil") || "[]");

    const enRows = document.getElementById("english-event-rows");
    const taRows = document.getElementById("tamil-event-rows");

    enRows.innerHTML = "";
    taRows.innerHTML = "";

    for (let i = 0; i < MAX_EVENTS; i++) {
      const en = englishEvents[i] || { date: "", info: "" };
      const ta = tamilEvents[i] || { date: "", info: "" };

      enRows.innerHTML += `
        <tr>
          <td><input type="text" id="en-date-${i}" value="${en.date}" /></td>
          <td><textarea id="en-info-${i}">${en.info}</textarea></td>
          <td><button onclick="updateEvent('english', ${i})">Update</button></td>
        </tr>`;

      taRows.innerHTML += `
        <tr>
          <td><input type="text" id="ta-date-${i}" value="${ta.date}" /></td>
          <td><textarea id="ta-info-${i}">${ta.info}</textarea></td>
          <td><button onclick="updateEvent('tamil', ${i})">புதுப்பிக்க</button></td>
        </tr>`;
    }
  }

  function updateEvent(lang, index) {
    const prefix = lang === 'english' ? 'en' : 'ta';
    const date = document.getElementById(`${prefix}-date-${index}`).value.trim();
    const info = document.getElementById(`${prefix}-info-${index}`).value.trim();

    const key = lang === 'english' ? 'events_english' : 'events_tamil';
    const events = JSON.parse(localStorage.getItem(key) || "[]");
    events[index] = { date, info };
    localStorage.setItem(key, JSON.stringify(events));
    alert(`${lang === 'english' ? 'English' : 'தமிழ்'} event ${index + 1} updated.`);
  }

  // === Announcements ===
  function saveAnnouncement(type) {
    const title = document.getElementById(`${type}-title`).value.trim();
    const info = document.getElementById(`${type}-info`).value.trim();
    const html = `<strong>${title}</strong><p>${info}</p>`;
    localStorage.setItem(`${type}_announcement`, html);
    alert(`${type.charAt(0).toUpperCase() + type.slice(1)} announcement updated.`);
  }
</script>

</body>
</html>
